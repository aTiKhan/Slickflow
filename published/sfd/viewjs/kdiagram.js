import kconfig from"../config/kconfig.js";import jshelper from"../script/jshelper.js";const kdiagram=function(){function e(){}return e.loadXml=function(e,r,t){var n={ProcessGUID:r,Version:t},s={AppInstanceID:e,ProcessGUID:r,Version:t};jshelper.ajaxPost(kconfig.webApiUrl+"api/Wf2Xml/QueryProcessFile",JSON.stringify(n),(function(e){if(1===e.Status){var r=e.Entity.XmlContent,t=new BpmnJS({container:$("#js-canvas"),height:600});try{const e=t.importXML(r),{warnings:n}=e}catch(e){console.log(e.message,e.warnings)}jshelper.ajaxPost(kconfig.webApiUrl+"api/Wf2Xml/QueryReadyActivityInstance",JSON.stringify(s),(function(e){1===e.Status?function(e,r){var t=r.get("elementRegistry").filter((function(r){return("bpmn:Task"===r.type||"bpmn:UserTask"===r.type)&&function(e,r){var t=!1;return $.each(e,(function(e,n){if(r.businessObject.$attrs["sf:guid"]===n.ActivityGUID)return t=!0,!1})),t}(e,r)}));r.get("modeling").setColor(t,{stroke:"yellow",fill:"green"})}(e.Entity,t):kmsgbox.error(kresource.getItem("processdiagramreaderrormsg"),e.Message)})),jshelper.ajaxPost(kconfig.webApiUrl+"api/Wf2Xml/QueryCompletedTransitionInstance",JSON.stringify(s),(function(e){1===e.Status?function(e,r){var t=r.get("elementRegistry").filter((function(r){return"bpmn:SequenceFlow"===r.type&&function(e,r){var t=!1;return $.each(e,(function(e,n){if(r.businessObject.$attrs["sf:guid"]===n.TransitionGUID)return t=!0,!1})),t}(e,r)}));r.get("modeling").setColor(t,{stroke:"red",fill:"yellow"})}(e.Entity,t):kmsgbox.error(kresource.getItem("processdiagramreaderrormsg"),e.Message)}))}else kmsgbox.error(kresource.getItem("processdiagramreaderrormsg"),e.Message)}))},e}();window.kdiagram=kdiagram;export default kdiagram;